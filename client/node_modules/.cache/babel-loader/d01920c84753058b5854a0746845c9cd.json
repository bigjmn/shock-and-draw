{"ast":null,"code":"import _slicedToArray from\"/Users/jessenicholas/shock-draw-final/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import Controls from\"../Controls/Controls\";import socket from'../../context/socket.js';import classes from'./Canvas.module.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Canvas(){var canvasRef=React.useRef(null);var parentRef=React.useRef(null);var _useState=useState({}),_useState2=_slicedToArray(_useState,2),ctx=_useState2[0],setCtx=_useState2[1];var _useState3=useState({x:0,y:0}),_useState4=_slicedToArray(_useState3,2),canvasOffset=_useState4[0],setCanvasOffset=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),drawing=_useState6[0],setDrawing=_useState6[1];var _useState7=useState({x:0,y:0}),_useState8=_slicedToArray(_useState7,2),position=_useState8[0],setPosition=_useState8[1];var _useState9=useState(\"#000000\"),_useState10=_slicedToArray(_useState9,2),color=_useState10[0],setColor=_useState10[1];var _useState11=useState(5),_useState12=_slicedToArray(_useState11,2),thickness=_useState12[0],setThickness=_useState12[1];var _useState13=useState(false),_useState14=_slicedToArray(_useState13,2),activeTake=_useState14[0],setActiveTake=_useState14[1];// const [drawPack, setDrawPack] = useState([])\n// const addPack = (payload) => {\n//   setDrawPack((oldPack) =>  [...oldPack, payload])\n//   console.log(drawPack)\n// }\nfunction throttled(delay,fn){var lastCall=0;return function(){var now=new Date().getTime();if(now-lastCall<delay){return;}lastCall=now;return fn.apply(void 0,arguments);};}useEffect(function(){var canv=canvasRef.current;canv.width=parentRef.current.offsetWidth;canv.height=parentRef.current.offsetHeight;var canvCtx=canv.getContext(\"2d\");canvCtx.lineJoin=\"round\";canvCtx.lineCap=\"round\";setCtx(canvCtx);var offset=canv.getBoundingClientRect();setCanvasOffset({x:parseInt(offset.left),y:parseInt(offset.top)});},[ctx]);useEffect(function(){socket.on('takeClear',function(){ctx.clearRect(0,0,500,500);});return function(){socket.off('takeClear');};});function handleMouseDown(e){setDrawing(true);setPosition({x:parseInt(e.clientX-canvasOffset.x),y:parseInt(e.clientY-canvasOffset.y)});}function handleMouseUp(){setDrawing(false);}var handleMouseMove=function handleMouseMove(e){var mousex=e.clientX-canvasOffset.x;var mousey=e.clientY-canvasOffset.y;if(drawing){ctx.strokeStyle=color;ctx.lineWidth=thickness;ctx.beginPath();ctx.moveTo(position.x,position.y);ctx.lineTo(mousex,mousey);ctx.stroke();var payload={oldx:position.x,oldy:position.y,newx:mousex,newy:mousey,color:color,thickness:thickness};socket.emit('sendPack',{payload:payload});}setPosition({x:mousex,y:mousey});};var throttledhandleMouseMove=throttled(50,handleMouseMove);function handleColor(color){setColor(color);}var handleSize=function handleSize(size){setThickness(size);};var handleTaker=function handleTaker(){setActiveTake(!activeTake);console.log(activeTake);};return/*#__PURE__*/_jsxs(\"div\",{className:\"Canvas\",ref:parentRef,children:[/*#__PURE__*/_jsx(\"div\",{className:classes.controlContainer,children:/*#__PURE__*/_jsx(Controls,{handleColor:handleColor,handleSize:handleSize,activeTake:activeTake})}),/*#__PURE__*/_jsx(\"canvas\",{ref:canvasRef,onMouseDown:handleMouseDown,onMouseUp:handleMouseUp,onMouseMove:throttledhandleMouseMove,height:\"500\",width:\"500\",style:{border:\"1px solid\"}})]});}export default Canvas;","map":{"version":3,"sources":["/Users/jessenicholas/shock-draw-final/client/src/components/Canvas/Canvas.js"],"names":["React","useState","useEffect","Controls","socket","classes","Canvas","canvasRef","useRef","parentRef","ctx","setCtx","x","y","canvasOffset","setCanvasOffset","drawing","setDrawing","position","setPosition","color","setColor","thickness","setThickness","activeTake","setActiveTake","throttled","delay","fn","lastCall","now","Date","getTime","canv","current","width","offsetWidth","height","offsetHeight","canvCtx","getContext","lineJoin","lineCap","offset","getBoundingClientRect","parseInt","left","top","on","clearRect","off","handleMouseDown","e","clientX","clientY","handleMouseUp","handleMouseMove","mousex","mousey","strokeStyle","lineWidth","beginPath","moveTo","lineTo","stroke","payload","oldx","oldy","newx","newy","emit","throttledhandleMouseMove","handleColor","handleSize","size","handleTaker","console","log","controlContainer","border"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport Controls from \"../Controls/Controls\";\nimport socket from '../../context/socket.js'\n\nimport classes from './Canvas.module.css'\n\nfunction Canvas() {\n  const canvasRef = React.useRef(null);\n  const parentRef = React.useRef(null);\n  const [ctx, setCtx] = useState({});\n  const [canvasOffset, setCanvasOffset] = useState({ x: 0, y: 0 });\n  const [drawing, setDrawing] = useState(false);\n  const [position, setPosition] = useState({ x: 0, y: 0 });\n  const [color, setColor] = useState(\"#000000\");\n  const [thickness, setThickness] = useState(5)\n  const [activeTake, setActiveTake] = useState(false)\n\n\n  // const [drawPack, setDrawPack] = useState([])\n\n\n\n\n  // const addPack = (payload) => {\n  //   setDrawPack((oldPack) =>  [...oldPack, payload])\n  //   console.log(drawPack)\n  // }\n  function throttled(delay, fn) {\n  let lastCall = 0;\n  return function (...args) {\n    const now = (new Date).getTime();\n    if (now - lastCall < delay) {\n      return;\n    }\n    lastCall = now;\n    return fn(...args);\n  }\n}\n\n\n\n\n\n\n\n\n\n\n  useEffect(() => {\n    let canv = canvasRef.current;\n    canv.width = parentRef.current.offsetWidth;\n    canv.height = parentRef.current.offsetHeight;\n\n    let canvCtx = canv.getContext(\"2d\");\n    canvCtx.lineJoin = \"round\";\n    canvCtx.lineCap = \"round\";\n\n    setCtx(canvCtx);\n\n    let offset = canv.getBoundingClientRect();\n    setCanvasOffset({ x: parseInt(offset.left), y: parseInt(offset.top) });\n  }, [ctx]);\n\n  useEffect(() => {\n    socket.on('takeClear', () => {\n      ctx.clearRect(0,0,500,500)\n    })\n    return () => {\n      socket.off('takeClear')\n    }\n  })\n\n  function handleMouseDown(e) {\n    setDrawing(true);\n    setPosition({\n      x: parseInt(e.clientX - canvasOffset.x),\n      y: parseInt(e.clientY - canvasOffset.y),\n    });\n  }\n  function handleMouseUp() {\n    setDrawing(false);\n  }\n\n  const handleMouseMove = (e) => {\n    let mousex = e.clientX - canvasOffset.x;\n    let mousey = e.clientY - canvasOffset.y;\n    if (drawing) {\n      ctx.strokeStyle = color;\n      ctx.lineWidth = thickness;\n      ctx.beginPath();\n      ctx.moveTo(position.x, position.y);\n      ctx.lineTo(mousex, mousey);\n      ctx.stroke();\n      var payload = {\n        oldx: position.x,\n        oldy: position.y,\n        newx: mousex,\n        newy: mousey,\n        color: color,\n        thickness: thickness\n      }\n\n      socket.emit('sendPack', {payload:payload})\n\n    }\n    setPosition({ x: mousex, y: mousey });\n  }\n\n  const throttledhandleMouseMove = throttled(50, handleMouseMove)\n\n  function handleColor(color) {\n    setColor(color);\n  }\n  const handleSize = (size) => {\n    setThickness(size)\n  }\n  const handleTaker = () => {\n\n    setActiveTake(!activeTake)\n    console.log(activeTake)\n  }\n\n  return (\n\n\n\n    <div className=\"Canvas\" ref={parentRef}>\n      <div className={classes.controlContainer}>\n        <Controls handleColor={handleColor} handleSize={handleSize} activeTake={activeTake}/>\n\n      </div>\n\n\n\n\n      <canvas\n        ref={canvasRef}\n        onMouseDown={handleMouseDown}\n        onMouseUp={handleMouseUp}\n        onMouseMove={throttledhandleMouseMove}\n        height=\"500\" width=\"500\"\n\n\n        style={{border:\"1px solid\"}}\n\n      />\n\n    </div>\n\n  );\n\n}\n\nexport default Canvas;\n"]},"metadata":{},"sourceType":"module"}